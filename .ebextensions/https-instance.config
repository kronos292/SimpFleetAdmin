files:
  /etc/nginx/conf.d/https.conf:
    mode: "000644"
    owner: root
    group: root
    content: |
      # HTTPS server

      server {
          listen       443;
          server_name  localhost;

          ssl                  on;
          ssl_certificate      /etc/pki/tls/certs/server.crt;
          ssl_certificate_key  /etc/pki/tls/certs/server.key;

          ssl_session_timeout  5m;

          ssl_protocols  TLSv1 TLSv1.1 TLSv1.2;
          ssl_prefer_server_ciphers   on;

          location / {
              proxy_pass  http://nodejs;
              proxy_set_header   Connection "";
              proxy_http_version 1.1;
              proxy_set_header        Host            $host;
              proxy_set_header        X-Real-IP       $remote_addr;
              proxy_set_header        X-Forwarded-For $proxy_add_x_forwarded_for;
              proxy_set_header        X-Forwarded-Proto https;
          }
      }
  /etc/pki/tls/certs/server.crt:
    mode: "000400"
    owner: root
    group: root
    content: |
      -----BEGIN CERTIFICATE-----
      MIIFkjCCBHqgAwIBAgISBBuyaEiT9R9ihRB3+tkO4BCgMA0GCSqGSIb3DQEBCwUAMEoxCzAJBgNVBAYTAlVTMRYwFAYDVQQKEw1MZXQncyBFbmNyeXB0MSMwIQYDVQQDExpMZXQncyBFbmNyeXB0IEF1dGhvcml0eSBYMzAeFw0xOTExMDEwNzQyMjdaFw0yMDAxMzAwNzQyMjdaMBgxFjAUBgNVBAMTDXNpbXBmbGVldC5jb20wggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCrhyjvz3otF8bZk1q5egUva7G/AX21vJttZq25nErUS5mg/GHUu1mkBnJCkbIfQgkyhSAgrkabWI6C6e8r58At1lFStTPW6Mgjw40ikBYJxthhTCQbdMN0QAobu2kOvkD8jfQPLimpstO7MJn+Gb2y3e1CvqTTBcfORu1pJt0jP8jUYOSzDSWHe9G2HRJ3xbTI+dEiItp8/KbrkP8UlcH6GjZcquIEE6DtFhryf5A9yZcvROPJ2DPV0m6hZP+5pTV+0V0f7Wg40yfFLjVyq0k3cpRM7e0SVbqJKCthEdNZQ4hz2G+uHE9U2r0TLfJf+ARWcVJ5mEI7qwfCYSbRBFk9AgMBAAGjggKiMIICnjAOBgNVHQ8BAf8EBAMCBaAwHQYDVR0lBBYwFAYIKwYBBQUHAwEGCCsGAQUFBwMCMAwGA1UdEwEB/wQCMAAwHQYDVR0OBBYEFPqxIOk8uBsulPkuBSI0cisLtnowMB8GA1UdIwQYMBaAFKhKamMEfd265tE5t6ZFZe/zqOyhMG8GCCsGAQUFBwEBBGMwYTAuBggrBgEFBQcwAYYiaHR0cDovL29jc3AuaW50LXgzLmxldHNlbmNyeXB0Lm9yZzAvBggrBgEFBQcwAoYjaHR0cDovL2NlcnQuaW50LXgzLmxldHNlbmNyeXB0Lm9yZy8wWAYDVR0RBFEwT4ITYWRtaW4uc2ltcGZsZWV0LmNvbYIWcGFydG5lcnMuc2ltcGZsZWV0LmNvbYINc2ltcGZsZWV0LmNvbYIRd3d3LnNpbXBmbGVldC5jb20wTAYDVR0gBEUwQzAIBgZngQwBAgEwNwYLKwYBBAGC3xMBAQEwKDAmBggrBgEFBQcCARYaaHR0cDovL2Nwcy5sZXRzZW5jcnlwdC5vcmcwggEEBgorBgEEAdZ5AgQCBIH1BIHyAPAAdgBep3P531bA57U2SH3QSeAyepGaDIShEhKEGHWWgXFFWAAAAW4mIVEEAAAEAwBHMEUCIFQAJek11esx5Rh8RpcDW0vCZf13t0GhQYOcxrAODmBTAiEAgsDgageHnEzprzC2hSmYJse0Uww4pOOrZ5ZrcNNAoCcAdgCyHgXMi6LNiiBOh2b5K7mKJSBna9r6cOeySVMt74uQXgAAAW4mIVEFAAAEAwBHMEUCIHHmzJr81zxX4mOdZvyFGKYQ9oTSB6o+t085uSjXCFAJAiEAwqJ+BnSTabQJk8ELjR3gjwOwdAYASi3VSbv0QIv+AKAwDQYJKoZIhvcNAQELBQADggEBAGQHM24JIefQtmBgjwkd188VYisnRePAu7l6nG0wJf6ZRLr+L7mSL7jb2+8zKpKZjx/XnzqCcxaX5fouLD/y2JDIPrP4QT0brdJNiQc9mEiRiAP6b+SPQadLuQoD3+ZtJAoUwXL+A5fCy9DDH1g8v5Rn3GwNSp3GKXXyropL00/dDSVPZs+DFPKnWQ5295ajM+sq8dV4+vWRy3CYTcVHqRcWcWY40hM8vmZaUvGl/9JgrPZXlyLBwPKp5otC8b2i+EySVXG9LHI46f2QEZn2HsjYs94CuoegwXdY3wskidtEUihFSMrffg6c3G5ahbSboFR1aMgcGVjgrV/QxwpQst4=
      -----END CERTIFICATE-----

  /etc/pki/tls/certs/server.key:
    mode: "000400"
    owner: root
    group: root
    content: |
      -----BEGIN RSA PRIVATE KEY-----
      MIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQCrhyjvz3otF8bZk1q5egUva7G/AX21vJttZq25nErUS5mg/GHUu1mkBnJCkbIfQgkyhSAgrkabWI6C6e8r58At1lFStTPW6Mgjw40ikBYJxthhTCQbdMN0QAobu2kOvkD8jfQPLimpstO7MJn+Gb2y3e1CvqTTBcfORu1pJt0jP8jUYOSzDSWHe9G2HRJ3xbTI+dEiItp8/KbrkP8UlcH6GjZcquIEE6DtFhryf5A9yZcvROPJ2DPV0m6hZP+5pTV+0V0f7Wg40yfFLjVyq0k3cpRM7e0SVbqJKCthEdNZQ4hz2G+uHE9U2r0TLfJf+ARWcVJ5mEI7qwfCYSbRBFk9AgMBAAECggEABHFcSJXdqsRWZLVR4ML91mQaNwHRYT8w4W0K6+dV8tjAcnCHEi0GHd8C36GJdRDPTy0uj1okPwrUqiRoCwGWMzm9YoCKBrOB15dNlQsZXwh0+1QvDT0BgQXVnTFF/9lCsqf0nd4KuzgEDvGr026UQMlJx3RLraGVMs0YgiQ9DxgheBX1/Px5ZOnKljo1acQzH4lULufPg3kLg1E0I2Jq6DyScSQ9Jd5y+M6WLrgJdFTa8dGfT8q6L8QkqhzQyBdYc59s2naMFvirmMeziV0woMsTRXO+2lSG4JBPJfu88cifgcGlGZD65bRNcVVqaKfFyMz/QKHGHRNpi8ROlFILQQKBgQDg64A6CSSs/QcpJ9tduYUdm1CPi9PAVgvl9LQLiTzD6glLgzGPdKA9LtfxgRDzGf4bPVVLg8LFzQ0lBSkbYaaNllVcZ05oFwF/BPh+1ypOL56rZz1iGBlNsFdiITMOdv3uCsnW4NKqWDVw4V+RfG9JUxr5kjwKhhusKIpK+AozIQKBgQDDOu3GpZ2cmfYNq8VXi91fy6RSXft9fkAoSjp11LVR0IC3UNAR7AiQkgvxmOlFif9SOEdYuGROhBVgy+SWxBs6WXWsIjP+KzSUjL0Xy21gYJ/Lj3/JBj5avG9oAiFwIBgDxPPs2Ly3z3Ktv4N2+MVdf/B3kvphWv6jIh5KX0E+nQKBgQCFKOfxdBhSkjr7Eq28/2jf7mPzmET1SfwhWI5/hfCDzLtUCYf99n4nuuP+BvuR8YGPfvBQlOFrWcq+cB+2JkoE6UwAOOkilvw7xyWXcquJPogh0i11Ne9FH3GclyszFR+hHqIApXoTf8Wj3spFx/Xa42jE+N6zHFKlyhqV5+OiAQKBgFaiHcWa1Jgbkh567PVucWwDGAYdAm6ryZiXZ93F6DhIB/ZQ/CQX060jwf0R1+It3IkFxFNQb+KPplTv5Z4po9N+w0MBYoUVcx3AXmDiusSb3A0evpvcE2t8VwuWdnQlKcLycTPW8de3TLJhW9s9hYd6MKE/LbBqCrkleL+UCYXZAoGBAKpapng+VDTmw3Y9Jzr69h6T9QZdJaYQzRrEDhOob+bgJmFGo/aGrIDhHobc61hcliY6AOVErAPSw2vTbSe0y+g6Jzosj/w68PDDVft/kkRgKOxMnS5/D6z6pKlfMBWy9EeRfnmvrYGNRcw8Ruhag1foXkSLltRgUCamtzIHXQc+
      -----END RSA PRIVATE KEY-----
